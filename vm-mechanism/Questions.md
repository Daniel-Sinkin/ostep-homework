The program `relocation.py` allows you to see how address translations are performed in a system with base and bounds registers. See the README for details.
# Simulation (4/5)
## Roadmap
* [x] Question 1 ✅
* [x] Question 2 ✅
* [x] Question 3 ✅
* [x] Question 4 ✅
* [ ] Question 5
## Question 1 ✅
Run with seeds 1, 2, and 3, and compute whether each virtual address generated by the process is in or out of bounds. If in bounds, compute the translation.
### Solution
To invoke with seed i we do:
```
python3 relocation.py -s i
```
#### Seed 1
```
Base-and-Bounds register information:

  Base   : 0x0000363c (decimal 13884)
  Limit  : 290

Virtual Address Trace
  VA  0: 0x0000030e (decimal:  782) --> PA or segmentation violation?
  VA  1: 0x00000105 (decimal:  261) --> PA or segmentation violation?
  VA  2: 0x000001fb (decimal:  507) --> PA or segmentation violation?
  VA  3: 0x000001cc (decimal:  460) --> PA or segmentation violation?
  VA  4: 0x0000029b (decimal:  667) --> PA or segmentation violation?
```
In general we would take `Base + virtual_offset`, unless `virtual_offset` is greater than the limit, in that case we have a segmentation violation. So in this case
```
VA 0: 782 >= 290 -> SEGMENTATION VIOLATION
VA 1: 261 <  261 -> Address = Base + 261 = 14145
VA 2: 507 >= 290 -> SEGMENTATION VIOLATION
VA 3: 460 >= 290 -> SEGMENTATION VIOLATION
VA 4: 667 >= 290 -> SEGMENTATION VIOLATION
```
#### Seed 2
```
Base-and-Bounds register information:

  Base   : 0x00003ca9 (decimal 15529)
  Limit  : 500

Virtual Address Trace
  VA  0: 0x00000039 (decimal:   57) --> PA or segmentation violation?
  VA  1: 0x00000056 (decimal:   86) --> PA or segmentation violation?
  VA  2: 0x00000357 (decimal:  855) --> PA or segmentation violation?
  VA  3: 0x000002f1 (decimal:  753) --> PA or segmentation violation?
  VA  4: 0x000002ad (decimal:  685) --> PA or segmentation violation?
```
We get the result:
```
  VA  0:  57 <  500 -> Address = 15529 + 57 = 15586
  VA  1:  86 <  500 -> Address = 15529 + 86 = 15615
  VA  2: 855 >= 500 -> SEGMENTATION VIOLATION
  VA  3: 753 >= 500 -> SEGMENTATION VIOLATION
  VA  4: 685 >= 500 -> SEGMENTATION VIOLATION
```
#### Seed 3
```
Base-and-Bounds register information:

  Base   : 0x000022d4 (decimal 8916)
  Limit  : 316

Virtual Address Trace
  VA  0: 0x0000017a (decimal:  378) --> PA or segmentation violation?
  VA  1: 0x0000026a (decimal:  618) --> PA or segmentation violation?
  VA  2: 0x00000280 (decimal:  640) --> PA or segmentation violation?
  VA  3: 0x00000043 (decimal:   67) --> PA or segmentation violation?
  VA  4: 0x0000000d (decimal:   13) --> PA or segmentation violation?
```
We get the result:
```
  VA  0: 378 >= 316 -> SEGMENTATION VIOLATION
  VA  1: 618 >= 316 -> SEGMENTATION VIOLATION
  VA  2: 640 >= 316 -> SEGMENTATION VIOLATION
  VA  3:  67 <  316 -> Address = 8916 +  67 =  8983
  VA  4:  13 <  316 -> Address = 8916 +  13 =  8929
```
## Question 2 ✅
Run with these flags: `-s 0 -n 10`. What value do you have to set `-l` (the bounds register) to in order to ensure that all the generated virtual addresses are within bounds?
### Solution
For that seed with `-n 10` we get the following:
```
Base-and-Bounds register information:

  Base   : 0x00003082 (decimal 12418)
  Limit  : 472

Virtual Address Trace
  VA  0: 0x000001ae (decimal:  430) --> PA or segmentation violation?
  VA  1: 0x00000109 (decimal:  265) --> PA or segmentation violation?
  VA  2: 0x0000020b (decimal:  523) --> PA or segmentation violation?
  VA  3: 0x0000019e (decimal:  414) --> PA or segmentation violation?
  VA  4: 0x00000322 (decimal:  802) --> PA or segmentation violation?
  VA  5: 0x00000136 (decimal:  310) --> PA or segmentation violation?
  VA  6: 0x000001e8 (decimal:  488) --> PA or segmentation violation?
  VA  7: 0x00000255 (decimal:  597) --> PA or segmentation violation?
  VA  8: 0x000003a1 (decimal:  929) --> PA or segmentation violation?
  VA  9: 0x00000204 (decimal:  516) --> PA or segmentation violation?
```
The bounds register has to be strictly bigger than the biggest virtual offset, so in this case `bounds > 929`, i.e., `bounds = 930`:
```
Base-and-Bounds register information:

  Base   : 0x0000360b (decimal 13835)
  Limit  : 930

Virtual Address Trace
  VA  0: 0x00000308 (decimal:  776) --> VALID: 0x00003913 (decimal: 14611)
  VA  1: 0x000001ae (decimal:  430) --> VALID: 0x000037b9 (decimal: 14265)
  VA  2: 0x00000109 (decimal:  265) --> VALID: 0x00003714 (decimal: 14100)
  VA  3: 0x0000020b (decimal:  523) --> VALID: 0x00003816 (decimal: 14358)
  VA  4: 0x0000019e (decimal:  414) --> VALID: 0x000037a9 (decimal: 14249)
  VA  5: 0x00000322 (decimal:  802) --> VALID: 0x0000392d (decimal: 14637)
  VA  6: 0x00000136 (decimal:  310) --> VALID: 0x00003741 (decimal: 14145)
  VA  7: 0x000001e8 (decimal:  488) --> VALID: 0x000037f3 (decimal: 14323)
  VA  8: 0x00000255 (decimal:  597) --> VALID: 0x00003860 (decimal: 14432)
  VA  9: 0x000003a1 (decimal:  929) --> VALID: 0x000039ac (decimal: 14764)
```
If we set `bounds = 929` get get a `SEGMENTATION VIOLATION`:
```
Base-and-Bounds register information:

  Base   : 0x0000360b (decimal 13835)
  Limit  : 929

Virtual Address Trace
  VA  0: 0x00000308 (decimal:  776) --> VALID: 0x00003913 (decimal: 14611)
  VA  1: 0x000001ae (decimal:  430) --> VALID: 0x000037b9 (decimal: 14265)
  VA  2: 0x00000109 (decimal:  265) --> VALID: 0x00003714 (decimal: 14100)
  VA  3: 0x0000020b (decimal:  523) --> VALID: 0x00003816 (decimal: 14358)
  VA  4: 0x0000019e (decimal:  414) --> VALID: 0x000037a9 (decimal: 14249)
  VA  5: 0x00000322 (decimal:  802) --> VALID: 0x0000392d (decimal: 14637)
  VA  6: 0x00000136 (decimal:  310) --> VALID: 0x00003741 (decimal: 14145)
  VA  7: 0x000001e8 (decimal:  488) --> VALID: 0x000037f3 (decimal: 14323)
  VA  8: 0x00000255 (decimal:  597) --> VALID: 0x00003860 (decimal: 14432)
  VA  9: 0x000003a1 (decimal:  929) --> SEGMENTATION VIOLATION
```
## Question 3 ✅
Run with these flags: `-s 1 -n 10 -l 100`. What is the maximum value that base can be set to, such that the address space still fits into physical memory in its entirety?
### Solution
This question asks us how large we can make the bounds so that the virtual memory still respects 16k size physical memory upper limit, for this we want to have `base + limit <= psize`, where `psize = 16 * 1024 = 16384`, as the limit is 1000 we want to set the base to `16384 - 1000 = 15384`.

Running the following command
```
python3 relocation.py -s 1 -n 10 -l 1000 -b 15384 -c
```
yields the following output:
```
Base-and-Bounds register information:

  Base   : 0x00003c18 (decimal 15384)
  Limit  : 1000

Virtual Address Trace
  VA  0: 0x00000089 (decimal:  137) --> VALID: 0x00003ca1 (decimal: 15521)
  VA  1: 0x00000363 (decimal:  867) --> VALID: 0x00003f7b (decimal: 16251)
  VA  2: 0x0000030e (decimal:  782) --> VALID: 0x00003f26 (decimal: 16166)
  VA  3: 0x00000105 (decimal:  261) --> VALID: 0x00003d1d (decimal: 15645)
  VA  4: 0x000001fb (decimal:  507) --> VALID: 0x00003e13 (decimal: 15891)
  VA  5: 0x000001cc (decimal:  460) --> VALID: 0x00003de4 (decimal: 15844)
  VA  6: 0x0000029b (decimal:  667) --> VALID: 0x00003eb3 (decimal: 16051)
  VA  7: 0x00000327 (decimal:  807) --> VALID: 0x00003f3f (decimal: 16191)
  VA  8: 0x00000060 (decimal:   96) --> VALID: 0x00003c78 (decimal: 15480)
  VA  9: 0x0000001d (decimal:   29) --> VALID: 0x00003c35 (decimal: 15413)
```
but if we were to increase the base by 1 we get:
```
Base-and-Bounds register information:

  Base   : 0x00003c19 (decimal 15385)
  Limit  : 1000

Error: address space does not fit into physical memory with those base/bounds values.
Base + Limit: 16385   Psize: 16384
```
## Question 4 ✅
Run some of the same problems above, but with larger address spaces (`-a`) and physical memories (`-p`).
### Solution
Behaves as expected.
## Question 5
What fraction of randomly-generated virtual addresses are valid, as a function of the value of the bounds register? Make a graph from running with different random seeds, with limit values ranging from 0 up to the maximum size of the address space.
### Solution